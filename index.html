<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…ÙØªÙˆØ­</title>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    
    <!-- Google Fonts - Vazirmatn & Tajawal -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;700;900&family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        /* ===== RESET & BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ===== ØªÙ…â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ú¯ÛŒ ===== */
        :root[data-theme="dark"] {
            --primary: #6366f1;
            --primary-glow: rgba(99, 102, 241, 0.5);
            --accent: #f97316;
            --gold: #fbbf24;
            --bg: #0b1120;
            --bg-gradient: linear-gradient(135deg, #0b1120 0%, #1a2639 100%);
            --card: rgba(30, 41, 59, 0.8);
            --card-border: rgba(255, 255, 255, 0.05);
            --text: #f1f5f9;
            --text-dim: #94a3b8;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.05);
        }

        :root[data-theme="light"] {
            --primary: #4f46e5;
            --primary-glow: rgba(79, 70, 229, 0.3);
            --accent: #ea580c;
            --gold: #d97706;
            --bg: #f8fafc;
            --bg-gradient: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --card: rgba(255, 255, 255, 0.9);
            --card-border: rgba(0, 0, 0, 0.05);
            --text: #0f172a;
            --text-dim: #475569;
            --glass: rgba(255, 255, 255, 0.5);
            --glass-border: rgba(0, 0, 0, 0.05);
        }

        :root[data-theme="purple"] {
            --primary: #a855f7;
            --primary-glow: rgba(168, 85, 247, 0.5);
            --accent: #f97316;
            --gold: #eab308;
            --bg: #1e1b4b;
            --bg-gradient: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            --card: rgba(49, 46, 129, 0.8);
            --card-border: rgba(255, 255, 255, 0.1);
            --text: #f5f3ff;
            --text-dim: #c4b5fd;
            --glass: rgba(255, 255, 255, 0.03);
        }

        :root[data-theme="ocean"] {
            --primary: #0ea5e9;
            --primary-glow: rgba(14, 165, 233, 0.5);
            --accent: #f97316;
            --gold: #fbbf24;
            --bg: #164e63;
            --bg-gradient: linear-gradient(135deg, #164e63 0%, #0e7490 100%);
            --card: rgba(21, 94, 117, 0.8);
            --card-border: rgba(255, 255, 255, 0.1);
            --text: #ecfeff;
            --text-dim: #a5f3fc;
        }

        :root[data-theme="gold"] {
            --primary: #f59e0b;
            --primary-glow: rgba(245, 158, 11, 0.5);
            --accent: #ef4444;
            --gold: #fbbf24;
            --bg: #78350f;
            --bg-gradient: linear-gradient(135deg, #78350f 0%, #92400e 100%);
            --card: rgba(146, 64, 14, 0.8);
            --card-border: rgba(255, 255, 255, 0.1);
            --text: #fffbeb;
            --text-dim: #fcd34d;
        }

        body {
            font-family: 'Vazirmatn', 'Tajawal', sans-serif;
            background: var(--bg-gradient);
            color: var(--text);
            min-height: 100vh;
            padding: 16px;
            padding-bottom: 80px;
            transition: background 0.5s ease;
            backdrop-filter: blur(10px);
        }

        /* ===== HEADER Ù…Ø¯Ø±Ù† ===== */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding: 12px 20px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            backdrop-filter: blur(10px);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.3rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-controls {
            display: flex;
            gap: 8px;
        }

        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.3s;
            color: var(--text);
        }

        .header-btn:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        /* ===== Ø²Ø¨Ø§Ù† Ùˆ ØªÙ… (Ù¾Ø§Ù¾â€ŒØ¢Ù¾) ===== */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--card);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            padding: 24px;
            width: 90%;
            max-width: 350px;
            backdrop-filter: blur(20px);
        }

        .modal-title {
            font-size: 1.2rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .lang-option {
            padding: 12px;
            text-align: center;
            border-radius: 20px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            cursor: pointer;
            transition: 0.3s;
        }

        .lang-option.active {
            background: var(--primary);
            color: white;
        }

        .theme-option {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 20px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: 0.3s;
        }

        .theme-option.active {
            border-color: var(--gold);
            transform: scale(1.05);
        }

        .theme-option[data-theme="dark"] { background: #0b1120; }
        .theme-option[data-theme="light"] { background: #f8fafc; border: 1px solid #000; }
        .theme-option[data-theme="purple"] { background: #1e1b4b; }
        .theme-option[data-theme="ocean"] { background: #164e63; }
        .theme-option[data-theme="gold"] { background: #78350f; }

        .close-btn {
            width: 100%;
            padding: 12px;
            border-radius: 30px;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        /* ===== Ú©Ø§Ø±ÙˆØ³Ù„ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ ===== */
        .special-section {
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .section-header i {
            color: var(--gold);
            font-size: 1.2rem;
        }

        .special-carousel {
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            scroll-behavior: smooth;
            padding-bottom: 10px;
        }

        .special-carousel::-webkit-scrollbar {
            display: none;
        }

        .carousel-track {
            display: flex;
            gap: 15px;
        }

        .special-card {
            min-width: 280px;
            background: var(--card);
            border: 1px solid var(--card-border);
            border-radius: 24px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            transition: 0.3s;
            cursor: pointer;
            position: relative;
        }

        .special-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px var(--primary-glow);
        }

        .special-image {
            width: 100%;
            height: 150px;
            position: relative;
            overflow: hidden;
        }

        .special-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .special-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, var(--gold), var(--accent));
            color: black;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: bold;
            z-index: 2;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .special-info {
            padding: 12px;
        }

        .special-title {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .special-price {
            color: var(--gold);
            font-weight: 900;
            font-size: 1.1rem;
        }

        /* ===== Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ ===== */
        .categories {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            margin-bottom: 24px;
            padding: 5px 0;
        }

        .category-chip {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            padding: 10px 20px;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: 0.3s;
            backdrop-filter: blur(10px);
        }

        .category-chip.active {
            background: var(--primary);
            color: white;
        }

        .category-chip i {
            font-size: 1rem;
        }

        /* ===== Ø¬Ø³ØªØ¬Ùˆ ===== */
        .search-container {
            position: relative;
            margin-bottom: 24px;
        }

        .search-input {
            width: 100%;
            padding: 16px 50px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 40px;
            color: var(--text);
            font-size: 1rem;
            backdrop-filter: blur(10px);
        }

        .search-input::placeholder {
            color: var(--text-dim);
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-dim);
        }

        .search-clear {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-dim);
            cursor: pointer;
            display: none;
        }

        /* ===== Ø´Ø¨Ú©Ù‡ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ (Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¯Ø±Ù†) ===== */
        .ads-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .ad-card {
            background: var(--card);
            border: 1px solid var(--card-border);
            border-radius: 24px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            transition: 0.3s;
            cursor: pointer;
            position: relative;
        }

        .ad-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px var(--primary-glow);
        }

        .ad-card.special {
            border: 2px solid var(--gold);
        }

        .ad-image-container {
            position: relative;
            width: 100%;
            height: 140px;
            overflow: hidden;
        }

        .ad-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: 0.5s;
        }

        .ad-card:hover .ad-image {
            transform: scale(1.1);
        }

        .ad-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--gold);
            color: black;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.6rem;
            font-weight: bold;
            z-index: 2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .ad-price-badge {
            position: absolute;
            bottom: 8px;
            left: 8px;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            color: var(--gold);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: bold;
            z-index: 2;
        }

        .ad-info {
            padding: 12px;
        }

        .ad-title {
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ad-copy {
            color: var(--text-dim);
            font-size: 0.8rem;
            cursor: pointer;
            padding: 5px;
        }

        .ad-price {
            color: var(--accent);
            font-weight: 900;
            font-size: 1rem;
            margin: 5px 0;
        }

        .ad-location {
            color: var(--text-dim);
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 5px;
        }

        .ad-actions {
            display: flex;
            gap: 5px;
            margin-top: 8px;
        }

        .ad-btn {
            flex: 1;
            padding: 5px;
            border-radius: 12px;
            border: none;
            background: var(--glass);
            color: var(--text);
            font-size: 0.6rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
        }

        .ad-btn:hover {
            background: var(--primary);
        }

        /* ===== Ù†Ø§ÙˆØ¨Ø±ÛŒ Ù¾Ø§ÛŒÛŒÙ† ===== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            padding: 10px 20px;
            background: var(--glass);
            border-top: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--text-dim);
            cursor: pointer;
            transition: 0.3s;
            font-size: 0.7rem;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item i {
            font-size: 1.3rem;
        }

        /* ===== Ù…ÙˆØ¯Ø§Ù„ Ø¬Ø²Ø¦ÛŒØ§Øª ===== */
        .detail-modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(20px);
            z-index: 1000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }

        .detail-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 30px;
        }

        .back-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--glass);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .detail-image {
            width: 100%;
            height: 250px;
            border-radius: 30px;
            object-fit: cover;
            margin-bottom: 20px;
        }

        .detail-price-row {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .price-tag {
            background: var(--glass);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .translate-result {
            margin-top: 10px;
            padding: 10px;
            background: var(--glass);
            border-radius: 15px;
            display: none;
        }

        .loader {
            text-align: center;
            padding: 40px;
            color: var(--text-dim);
        }

        /* ===== Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ú©Ø§Ø±Ø¨Ø± ===== */
        .user-limit {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 10px 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.8rem;
        }

        .limit-progress {
            flex: 1;
            height: 6px;
            background: var(--glass);
            border-radius: 3px;
            overflow: hidden;
        }

        .limit-fill {
            height: 100%;
            background: var(--gold);
            border-radius: 3px;
            width: 0%;
        }

        /* ===== Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª ===== */
        .admin-panel {
            background: var(--card);
            border: 2px solid var(--gold);
            border-radius: 30px;
            padding: 20px;
            margin-top: 20px;
        }

        .admin-section {
            margin-bottom: 25px;
        }

        .admin-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--gold);
            margin-bottom: 15px;
        }

        .price-input-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .price-input {
            flex: 1;
            min-width: 100px;
            padding: 12px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            color: var(--text);
        }

        .save-btn {
            background: var(--gold);
            color: black;
            border: none;
            border-radius: 30px;
            padding: 12px 30px;
            font-weight: bold;
            cursor: pointer;
        }

        .pending-item {
            background: var(--glass);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 10px;
        }

        .pending-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .approve-btn {
            background: #10b981;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 5px 15px;
            cursor: pointer;
        }

        .reject-btn {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 5px 15px;
            cursor: pointer;
        }
    </style>
</head>
<body data-theme="dark">

    <!-- ===== Ù‡Ø¯Ø± Ù…Ø¯Ø±Ù† ===== -->
    <div class="header">
        <div class="logo">
            <i class="fas fa-store-alt"></i>
            <span id="logo-text">Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…ÙØªÙˆØ­</span>
        </div>
        <div class="header-controls">
            <div class="header-btn" onclick="openModal('lang')">
                <i class="fas fa-globe"></i>
            </div>
            <div class="header-btn" onclick="openModal('theme')">
                <i class="fas fa-palette"></i>
            </div>
        </div>
    </div>

    <!-- ===== Ù…ÙˆØ¯Ø§Ù„ Ø²Ø¨Ø§Ù† ===== -->
    <div id="lang-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title">
                <i class="fas fa-globe" style="color: var(--gold);"></i>
                <span id="modal-lang-title">Ø§Ù†ØªØ®Ø§Ø¨ Ø²Ø¨Ø§Ù†</span>
            </div>
            <div class="option-grid">
                <div class="lang-option active" onclick="setLang('fa')">ÙØ§Ø±Ø³ÛŒ</div>
                <div class="lang-option" onclick="setLang('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div>
                <div class="lang-option" onclick="setLang('en')">English</div>
            </div>
            <button class="close-btn" onclick="closeModal()" id="modal-close">Ø¨Ø³ØªÙ†</button>
        </div>
    </div>

    <!-- ===== Ù…ÙˆØ¯Ø§Ù„ ØªÙ… ===== -->
    <div id="theme-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title">
                <i class="fas fa-palette" style="color: var(--gold);"></i>
                <span id="modal-theme-title">Ø§Ù†ØªØ®Ø§Ø¨ ØªÙ…</span>
            </div>
            <div class="option-grid">
                <div class="theme-option" data-theme="dark" onclick="setTheme('dark')"></div>
                <div class="theme-option" data-theme="light" onclick="setTheme('light')"></div>
                <div class="theme-option" data-theme="purple" onclick="setTheme('purple')"></div>
                <div class="theme-option" data-theme="ocean" onclick="setTheme('ocean')"></div>
                <div class="theme-option" data-theme="gold" onclick="setTheme('gold')"></div>
            </div>
            <button class="close-btn" onclick="closeModal()" id="modal-close-theme">Ø¨Ø³ØªÙ†</button>
        </div>
    </div>

    <!-- ===== Ø¨Ø®Ø´ ÙˆÛŒÚ˜Ù‡ (Ú©Ø§Ø±ÙˆØ³Ù„) ===== -->
    <div class="special-section">
        <div class="section-header">
            <i class="fas fa-crown"></i>
            <span id="special-title">âœ¨ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡</span>
        </div>
        <div class="special-carousel" id="special-carousel">
            <div class="carousel-track" id="special-track"></div>
        </div>
    </div>

    <!-- ===== Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ ===== -->
    <div class="categories" id="categories">
        <div class="category-chip active" onclick="filterCategory('all', this)">
            <i class="fas fa-border-all"></i>
            <span id="cat-all">Ù‡Ù…Ù‡</span>
        </div>
        <div class="category-chip" onclick="filterCategory('Ø®ÙˆØ¯Ø±Ùˆ', this)">
            <i class="fas fa-car"></i>
            <span id="cat-car">Ø®ÙˆØ¯Ø±Ùˆ</span>
        </div>
        <div class="category-chip" onclick="filterCategory('Ø§Ù…Ù„Ø§Ú©', this)">
            <i class="fas fa-home"></i>
            <span id="cat-real">Ø§Ù…Ù„Ø§Ú©</span>
        </div>
        <div class="category-chip" onclick="filterCategory('Ù…ÙˆØ¨Ø§ÛŒÙ„', this)">
            <i class="fas fa-mobile-alt"></i>
            <span id="cat-phone">Ù…ÙˆØ¨Ø§ÛŒÙ„</span>
        </div>
        <div class="category-chip" onclick="filterCategory('Ù„Ù¾â€ŒØªØ§Ù¾', this)">
            <i class="fas fa-laptop"></i>
            <span id="cat-laptop">Ù„Ù¾â€ŒØªØ§Ù¾</span>
        </div>
        <div class="category-chip" onclick="filterCategory('Ø®Ø¯Ù…Ø§Øª', this)">
            <i class="fas fa-concierge-bell"></i>
            <span id="cat-service">Ø®Ø¯Ù…Ø§Øª</span>
        </div>
    </div>

    <!-- ===== Ø¬Ø³ØªØ¬Ùˆ ===== -->
    <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input type="text" class="search-input" id="search-input" placeholder="Ø¬Ø³ØªØ¬Ùˆ..." oninput="searchAds()">
        <i class="fas fa-times search-clear" id="search-clear" onclick="clearSearch()"></i>
    </div>

    <!-- ===== Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ú©Ø§Ø±Ø¨Ø± ===== -->
    <div class="user-limit" id="user-limit">
        <i class="fas fa-info-circle"></i>
        <span id="limit-text">Ø´Ù…Ø§ Û° Ø§Ø² Û² Ø¢Ú¯Ù‡ÛŒ Ø§ÛŒÙ† Ù…Ø§Ù‡ Ø±Ø§ Ø«Ø¨Øª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯</span>
        <div class="limit-progress">
            <div class="limit-fill" id="limit-progress" style="width: 0%"></div>
        </div>
    </div>

    <!-- ===== Ø´Ø¨Ú©Ù‡ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ ===== -->
    <div id="ads-container" class="ads-grid"></div>

    <!-- ===== Ù†Ø§ÙˆØ¨Ø±ÛŒ Ù¾Ø§ÛŒÛŒÙ† ===== -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="showTab('home')">
            <i class="fas fa-home"></i>
            <span id="nav-home">Ø®Ø§Ù†Ù‡</span>
        </div>
        <div class="nav-item" onclick="openBot()">
            <i class="fas fa-plus-circle"></i>
            <span id="nav-add">Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ</span>
        </div>
        <div class="nav-item" onclick="openSupport()">
            <i class="fas fa-headset"></i>
            <span id="nav-support">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</span>
        </div>
        <div class="nav-item" onclick="showTab('admin')">
            <i class="fas fa-cog"></i>
            <span id="nav-admin">Ù…Ø¯ÛŒØ±ÛŒØª</span>
        </div>
    </div>

    <!-- ===== Ù…ÙˆØ¯Ø§Ù„ Ø¬Ø²Ø¦ÛŒØ§Øª ===== -->
    <div id="detail-modal" class="detail-modal">
        <div class="detail-header">
            <div class="back-button" onclick="closeDetailModal()">
                <i class="fas fa-arrow-right"></i>
            </div>
            <span id="detail-title">Ø¬Ø²Ø¦ÛŒØ§Øª Ø¢Ú¯Ù‡ÛŒ</span>
        </div>
        <div id="detail-content"></div>
    </div>

    <!-- ===== Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª (Ù¾Ù†Ù‡Ø§Ù†) ===== -->
    <div id="admin-panel" style="display: none;">
        <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙˆØ³Ø· Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // ===== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ =====
        let currentUser = null;
        let isAdmin = false;
        let allAds = [];
        let currentCategory = 'all';
        let currentSearch = '';
        let userAdsCount = 0;
        let currentLang = 'fa';
        let currentTheme = 'dark';

        // ===== ØªØ±Ø¬Ù…Ù‡â€ŒÙ‡Ø§ =====
        const translations = {
            fa: {
                logo: 'Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…ÙØªÙˆØ­',
                special: 'âœ¨ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡',
                cat_all: 'Ù‡Ù…Ù‡',
                cat_car: 'Ø®ÙˆØ¯Ø±Ùˆ',
                cat_real: 'Ø§Ù…Ù„Ø§Ú©',
                cat_phone: 'Ù…ÙˆØ¨Ø§ÛŒÙ„',
                cat_laptop: 'Ù„Ù¾â€ŒØªØ§Ù¾',
                cat_service: 'Ø®Ø¯Ù…Ø§Øª',
                search: 'Ø¬Ø³ØªØ¬Ùˆ...',
                nav_home: 'Ø®Ø§Ù†Ù‡',
                nav_add: 'Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ',
                nav_support: 'Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ',
                nav_admin: 'Ù…Ø¯ÛŒØ±ÛŒØª',
                limit: 'Ø´Ù…Ø§ {count} Ø§Ø² Û² Ø¢Ú¯Ù‡ÛŒ Ø§ÛŒÙ† Ù…Ø§Ù‡ Ø±Ø§ Ø«Ø¨Øª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯',
                copy: 'Ú©Ù¾ÛŒ',
                translate: 'ØªØ±Ø¬Ù…Ù‡',
                detail_title: 'Ø¬Ø²Ø¦ÛŒØ§Øª Ø¢Ú¯Ù‡ÛŒ',
                modal_lang: 'Ø§Ù†ØªØ®Ø§Ø¨ Ø²Ø¨Ø§Ù†',
                modal_theme: 'Ø§Ù†ØªØ®Ø§Ø¨ ØªÙ…',
                close: 'Ø¨Ø³ØªÙ†'
            },
            ar: {
                logo: 'Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…ÙØªÙˆØ­',
                special: 'âœ¨ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù…ÙŠØ²Ø©',
                cat_all: 'Ø§Ù„ÙƒÙ„',
                cat_car: 'Ø³ÙŠØ§Ø±Ø§Øª',
                cat_real: 'Ø¹Ù‚Ø§Ø±Ø§Øª',
                cat_phone: 'Ø¬ÙˆØ§Ù„',
                cat_laptop: 'Ù„Ø§Ø¨ØªÙˆØ¨',
                cat_service: 'Ø®Ø¯Ù…Ø§Øª',
                search: 'Ø¨Ø­Ø«...',
                nav_home: 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
                nav_add: 'Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†',
                nav_support: 'Ø§Ù„Ø¯Ø¹Ù…',
                nav_admin: 'Ø¥Ø¯Ø§Ø±Ø©',
                limit: 'Ù„Ù‚Ø¯ Ø³Ø¬Ù„Øª {count} Ù…Ù† 2 Ø¥Ø¹Ù„Ø§Ù† Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±',
                copy: 'Ù†Ø³Ø®',
                translate: 'ØªØ±Ø¬Ù…Ø©',
                detail_title: 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†',
                modal_lang: 'Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ©',
                modal_theme: 'Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¸Ù‡Ø±',
                close: 'Ø¥ØºÙ„Ø§Ù‚'
            },
            en: {
                logo: 'Open Souq',
                special: 'âœ¨ Special Ads',
                cat_all: 'All',
                cat_car: 'Cars',
                cat_real: 'Real Estate',
                cat_phone: 'Phones',
                cat_laptop: 'Laptops',
                cat_service: 'Services',
                search: 'Search...',
                nav_home: 'Home',
                nav_add: 'Post Ad',
                nav_support: 'Support',
                nav_admin: 'Admin',
                limit: 'You have posted {count} of 2 ads this month',
                copy: 'Copy',
                translate: 'Translate',
                detail_title: 'Ad Details',
                modal_lang: 'Select Language',
                modal_theme: 'Select Theme',
                close: 'Close'
            }
        };

        // ===== ØªÙˆØ§Ø¨Ø¹ Ø²Ø¨Ø§Ù† =====
        function setLang(lang) {
            currentLang = lang;
            document.documentElement.dir = lang === 'en' ? 'ltr' : 'rtl';
            document.querySelectorAll('.lang-option').forEach(opt => opt.classList.remove('active'));
            event.target.classList.add('active');
            updateUIText();
            closeModal();
        }

        function updateUIText() {
            const t = translations[currentLang];
            document.getElementById('logo-text').innerText = t.logo;
            document.getElementById('special-title').innerText = t.special;
            document.getElementById('cat-all').innerText = t.cat_all;
            document.getElementById('cat-car').innerText = t.cat_car;
            document.getElementById('cat-real').innerText = t.cat_real;
            document.getElementById('cat-phone').innerText = t.cat_phone;
            document.getElementById('cat-laptop').innerText = t.cat_laptop;
            document.getElementById('cat-service').innerText = t.cat_service;
            document.getElementById('search-input').placeholder = t.search;
            document.getElementById('nav-home').innerText = t.nav_home;
            document.getElementById('nav-add').innerText = t.nav_add;
            document.getElementById('nav-support').innerText = t.nav_support;
            document.getElementById('nav-admin').innerText = t.nav_admin;
            document.getElementById('modal-lang-title').innerText = t.modal_lang;
            document.getElementById('modal-theme-title').innerText = t.modal_theme;
            document.getElementById('modal-close').innerText = t.close;
            document.getElementById('modal-close-theme').innerText = t.close;
            document.getElementById('detail-title').innerText = t.detail_title;
            
            updateUserLimitText();
        }

        function updateUserLimitText() {
            const t = translations[currentLang];
            const text = t.limit.replace('{count}', userAdsCount);
            document.getElementById('limit-text').innerText = text;
            document.getElementById('limit-progress').style.width = `${(userAdsCount / 2) * 100}%`;
        }

        // ===== ØªÙˆØ§Ø¨Ø¹ ØªÙ… =====
        function setTheme(theme) {
            currentTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
            event.target.classList.add('active');
            closeModal();
        }

        // ===== Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§ =====
        function openModal(type) {
            document.getElementById(`${type}-modal`).style.display = 'flex';
        }

        function closeModal() {
            document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none');
        }

        // ===== Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ =====
        async function init() {
            const user = tg.initDataUnsafe?.user;
            if (user) {
                currentUser = user;
                isAdmin = (user.id === 6522877528);
                
                // Ø¯Ø±ÛŒØ§ÙØª ØªØ¹Ø¯Ø§Ø¯ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
                await getUserAdsCount(user.id);
                
                // Ø§Ú¯Ø± Ø§Ø¯Ù…ÛŒÙ† Ø§Ø³ØªØŒ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†
                if (isAdmin) {
                    loadAdminPanel();
                }
            }

            // Ø¯Ø±ÛŒØ§ÙØª Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§
            await fetchAds();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ
            updateUIText();
        }

        async function getUserAdsCount(userId) {
            try {
                // Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ø§ÛŒØ¯ Ø§Ø² Worker Ø®ÙˆØ¯ ØªØ¹Ø¯Ø§Ø¯ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø¨Ú¯ÛŒØ±ÛŒ
                // ÙØ¹Ù„Ø§Ù‹ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                userAdsCount = 1; // Ù…Ø«Ø§Ù„
                updateUserLimitText();
            } catch (e) {
                console.log(e);
            }
        }

        async function fetchAds() {
            try {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                allAds = [
                    {
                        id: 1,
                        title: 'Ø¢ÛŒÙÙˆÙ† Û±Û³ Ù¾Ø±Ùˆ',
                        description: 'Ø¢ÛŒÙÙˆÙ† Û±Û³ Ù¾Ø±Ùˆ Ù…Ú©Ø³ Û²ÛµÛ¶ Ú¯ÛŒÚ¯Ø§Ø¨Ø§ÛŒØª',
                        price: 'ÛµÛµ,Û°Û°Û°,Û°Û°Û°',
                        currency: 'ØªÙˆÙ…Ø§Ù†',
                        cat: 'Ù…ÙˆØ¨Ø§ÛŒÙ„',
                        city: 'ØªÙ‡Ø±Ø§Ù†',
                        country: 'Ø§ÛŒØ±Ø§Ù†',
                        image_ids: '["photo1"]',
                        ad_type: 'special',
                        plan_days: 1,
                        created_at: Math.floor(Date.now() / 1000),
                        user_id: 'user123'
                    },
                    {
                        id: 2,
                        title: 'Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Û¸Û° Ù…ØªØ±ÛŒ',
                        description: 'Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Û¸Û° Ù…ØªØ±ÛŒ Ø¯Ø± ØªÙ‡Ø±Ø§Ù†Ù¾Ø§Ø±Ø³',
                        price: 'Û²,ÛµÛ°Û°,Û°Û°Û°,Û°Û°Û°',
                        currency: 'ØªÙˆÙ…Ø§Ù†',
                        cat: 'Ø§Ù…Ù„Ø§Ú©',
                        city: 'ØªÙ‡Ø±Ø§Ù†',
                        country: 'Ø§ÛŒØ±Ø§Ù†',
                        image_ids: '["photo2"]',
                        ad_type: 'normal',
                        created_at: Math.floor(Date.now() / 1000),
                        user_id: 'user456'
                    }
                ];
                
                renderSpecialCarousel();
                renderAds();
            } catch (e) {
                console.log(e);
            }
        }

        // ===== Ú©Ø§Ø±ÙˆØ³Ù„ ÙˆÛŒÚ˜Ù‡ =====
        function renderSpecialCarousel() {
            const specialAds = allAds.filter(ad => ad.ad_type === 'special');
            const track = document.getElementById('special-track');
            
            if (specialAds.length === 0) {
                track.innerHTML = '<div class="special-card">Ø¢Ú¯Ù‡ÛŒ ÙˆÛŒÚ˜Ù‡â€ŒØ§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</div>';
                return;
            }

            track.innerHTML = specialAds.map(ad => `
                <div class="special-card" onclick="showAdDetail(${JSON.stringify(ad).replace(/"/g, '&quot;')})">
                    <div class="special-image">
                        <img src="https://via.placeholder.com/300x150" alt="${ad.title}">
                        <span class="special-badge">âœ¨ ÙˆÛŒÚ˜Ù‡ ${ad.plan_days || 1} Ø±ÙˆØ²Ù‡</span>
                    </div>
                    <div class="special-info">
                        <div class="special-title">${ad.title}</div>
                        <div class="special-price">${ad.price}</div>
                        <div style="font-size:0.7rem; color:var(--text-dim);">${ad.city}</div>
                    </div>
                </div>
            `).join('');
        }

        // ===== Ù†Ù…Ø§ÛŒØ´ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ =====
        function renderAds() {
            let filteredAds = allAds;

            if (currentCategory !== 'all') {
                filteredAds = filteredAds.filter(ad => ad.cat === currentCategory);
            }

            if (currentSearch) {
                filteredAds = filteredAds.filter(ad => 
                    ad.title.includes(currentSearch) || 
                    ad.description.includes(currentSearch)
                );
            }

            const container = document.getElementById('ads-container');
            if (filteredAds.length === 0) {
                container.innerHTML = '<div class="loader">Ø¢Ú¯Ù‡ÛŒâ€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</div>';
                return;
            }

            container.innerHTML = filteredAds.map(ad => `
                <div class="ad-card ${ad.ad_type === 'special' ? 'special' : ''}" onclick="showAdDetail(${JSON.stringify(ad).replace(/"/g, '&quot;')})">
                    <div class="ad-image-container">
                        <img src="https://via.placeholder.com/300x140" class="ad-image" alt="${ad.title}">
                        ${ad.ad_type === 'special' ? '<span class="ad-badge">âœ¨ ÙˆÛŒÚ˜Ù‡</span>' : ''}
                        <span class="ad-price-badge">ğŸ’° ${ad.price}</span>
                    </div>
                    <div class="ad-info">
                        <div class="ad-title">
                            ${ad.title}
                            <i class="fas fa-copy ad-copy" onclick="copyText('${ad.title} - ${ad.description}', event)"></i>
                        </div>
                        <div class="ad-location">
                            <i class="fas fa-map-marker-alt"></i>
                            ${ad.city}ØŒ ${ad.country}
                        </div>
                        <div class="ad-actions">
                            <button class="ad-btn" onclick="translateText('${ad.description}', event)">
                                <i class="fas fa-language"></i>
                                <span>ØªØ±Ø¬Ù…Ù‡</span>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ===== ÙÛŒÙ„ØªØ± =====
        function filterCategory(cat, element) {
            currentCategory = cat;
            document.querySelectorAll('.category-chip').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
            renderAds();
        }

        function searchAds() {
            currentSearch = document.getElementById('search-input').value;
            document.getElementById('search-clear').style.display = currentSearch ? 'block' : 'none';
            renderAds();
        }

        function clearSearch() {
            document.getElementById('search-input').value = '';
            searchAds();
        }

        // ===== Ú©Ù¾ÛŒ Ù…ØªÙ† =====
        function copyText(text, event) {
            event.stopPropagation();
            navigator.clipboard.writeText(text);
            tg.showPopup({ message: 'âœ… Ù…ØªÙ† Ú©Ù¾ÛŒ Ø´Ø¯' });
        }

        // ===== ØªØ±Ø¬Ù…Ù‡ =====
        async function translateText(text, event) {
            event.stopPropagation();
            const btn = event.currentTarget;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            try {
                const response = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=fa|en`);
                const data = await response.json();
                const translated = data.responseData.translatedText;
                
                tg.showPopup({ 
                    title: 'ØªØ±Ø¬Ù…Ù‡',
                    message: translated,
                    buttons: [{ type: 'close' }]
                });
            } catch (e) {
                tg.showPopup({ message: 'Ø®Ø·Ø§ Ø¯Ø± ØªØ±Ø¬Ù…Ù‡' });
            }
            
            btn.innerHTML = originalText;
        }

        // ===== Ù†Ù…Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª =====
        function showAdDetail(ad) {
            const modal = document.getElementById('detail-modal');
            const content = document.getElementById('detail-content');
            
            content.innerHTML = `
                <img src="https://via.placeholder.com/600x250" class="detail-image" alt="${ad.title}">
                <h2>${ad.title}</h2>
                <div class="detail-price-row">
                    <span class="price-tag">ğŸ’° ${ad.price} ØªÙˆÙ…Ø§Ù†</span>
                    <span class="price-tag">ğŸ’µ ${Math.floor(ad.price.replace(/,/g,'') / 60000)}$ Ø¯Ù„Ø§Ø±</span>
                    <span class="price-tag">ğŸ’ ${Math.floor(ad.price.replace(/,/g,'') / 60000)} USDT</span>
                </div>
                <p style="margin: 20px 0;">${ad.description}</p>
                <div style="background: var(--glass); padding: 15px; border-radius: 15px;">
                    <p><i class="fas fa-map-marker-alt"></i> ${ad.city}ØŒ ${ad.country}</p>
                    <p><i class="fas fa-calendar"></i> ${new Date(ad.created_at * 1000).toLocaleDateString('fa-IR')}</p>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="ad-btn" style="flex: 1;" onclick="copyText('${ad.title} - ${ad.description}', event)">ğŸ“‹ Ú©Ù¾ÛŒ Ù…ØªÙ†</button>
                    <button class="ad-btn" style="flex: 1;" onclick="translateText('${ad.description}', event)">ğŸŒ ØªØ±Ø¬Ù…Ù‡</button>
                </div>
            `;
            
            modal.style.display = 'block';
            tg.BackButton.show();
        }

        function closeDetailModal() {
            document.getElementById('detail-modal').style.display = 'none';
            tg.BackButton.hide();
        }

        // ===== Ù†Ø§ÙˆØ¨Ø±ÛŒ =====
        function showTab(tab) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.nav-item').classList.add('active');
            
            if (tab === 'admin' && isAdmin) {
                // Ù†Ù…Ø§ÛŒØ´ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª
            }
        }

        function openBot() {
            tg.openTelegramLink('https://t.me/AlsouqAlmaftuhiran_bot');
        }

        function openSupport() {
            tg.openTelegramLink('https://t.me/Mehdi_E_admin');
        }

        // ===== Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª =====
        function loadAdminPanel() {
            // Ø§ÛŒÙ†Ø¬Ø§ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø§ Ù…ÛŒâ€ŒØ³Ø§Ø²ÛŒ
        }

        // ===== Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ =====
        init();

        // ===== Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª =====
        tg.BackButton.onClick(() => {
            if (document.getElementById('detail-modal').style.display === 'block') {
                closeDetailModal();
            }
        });
    </script>
</body>
</html>
